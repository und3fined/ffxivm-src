---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by Administrator.
--- DateTime: 2023/12/30 14:37
---

local LuaClass = require("Core/LuaClass")
local UIViewModel = require("UI/UIViewModel")
local ChocoboNameCfg = require("TableCfg/ChocoboNameCfg")
local BuddyColorCfg = require("TableCfg/BuddyColorCfg")
local ChocoboDefine = require("Game/Chocobo/ChocoboDefine")

---@class ChocoboHeadVM : UIViewModel
local ChocoboHeadVM = LuaClass(UIViewModel)

---Ctor
function ChocoboHeadVM:Ctor()
    self.ChocoboID = 0
    self.IsShow = false
    self.Color = ChocoboDefine.DEFAULT_HEAD_COLOR
    self.IsJoinMatch = false
    self.TextName = ""
end

function ChocoboHeadVM:UpdateVM(Data)
    if Data == nil then
        self.IsShow = false
        return
    end

    self.IsShow = true
    self.ChocoboID = Data.ID
    self.IsJoinMatch = Data.Outing
    local NameCfg = ChocoboNameCfg:FindValue(Data.Name.Name1, "Name") or ""
    local NameTb = {}
    for utfChar in string.gmatch(NameCfg, "[%z\1-\127\194-\244][\128-\191]*") do
        table.insert(NameTb, utfChar)
    end
    
    self.TextName = NameTb[1]
    local ColorCfg = BuddyColorCfg:FindCfgByKey(Data.Color.RGB)
    if ColorCfg ~= nil then
        self.Color = _G.UE.FLinearColor(ColorCfg.R / 255, ColorCfg.G / 255, ColorCfg.B / 255, 1)
    end
end

function ChocoboHeadVM:IsEqualVM(Value)
    return Value ~= nil and Value.ID == self.ChocoboID
end

return ChocoboHeadVM
---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by Administrator.
--- DateTime: 2024/12/24 11:03
---
local TouringBandDefine = require("Game/TouringBand/TouringBandDefine")

local TouringBandUtil = {}

function TouringBandUtil.Log(Msg)
    if TouringBandDefine.DEBUG then
        _G.FLOG_INFO("[TB]" .. Msg)
    end
end

function TouringBandUtil.Err(Msg)
    if TouringBandDefine.DEBUG then
        _G.FLOG_ERROR("[TB] " .. Msg)
    end
end

function TouringBandUtil.Wrn(Msg)
    if TouringBandDefine.DEBUG then
        _G.FLOG_WARNING("[TB] " .. Msg)
    end
end

function TouringBandUtil:GetTunePath(SoundName)
    if not SoundName then
        return
    end

    local SoundPath = string.format("AkAudioEvent'/Game/WwiseAudio/Events/sound/Instruments/%s/Play_%s.Play_%s'", SoundName, SoundName, SoundName)
    return SoundPath
end

--- 基于已旋转坐标进行新角度旋转
-- @param RotatedX number 已旋转后的X坐标
-- @param RotatedY number 已旋转后的Y坐标
-- @param Cx number 旋转中心X坐标
-- @param Cy number 旋转中心Y坐标
-- @param OriginalDegrees number 原始旋转角度（已应用过的顺时针角度）
-- @param NewDegrees number 新旋转角度（将要应用的顺时针角度）
-- @return number, number 新旋转后的X,Y坐标
function TouringBandUtil.CombinedRotation(RotatedX, RotatedY, Cx, Cy, OriginalDegrees, NewDegrees)
    -- 计算角度差并规范化到 [-180, 180)
    local DeltaDegrees = (NewDegrees - OriginalDegrees) % 360
    if DeltaDegrees > 180 then
        DeltaDegrees = DeltaDegrees - 360
    end

    -- 处理边界情况（角度差为0或360的整数倍）
    if math.abs(DeltaDegrees) == 0 then
        return RotatedX, RotatedY
    end

    local Radians = math.rad(DeltaDegrees)

    -- 计算旋转矩阵
    local CosTheta = math.cos(Radians)
    local SinTheta = math.sin(Radians)

    -- 平移到原点坐标系
    local TranslatedX = RotatedX - Cx
    local TranslatedY = RotatedY - Cy

    -- 应用旋转矩阵
    local NewX = TranslatedX * CosTheta - TranslatedY * SinTheta
    local NewY = TranslatedX * SinTheta + TranslatedY * CosTheta

    -- 平移回原坐标系
    return NewX + Cx, NewY + Cy
end

return TouringBandUtil


---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by Administrator.
--- DateTime: 2024/7/8 15:55
---

local LuaClass = require("Core/LuaClass")
local UIViewModel = require("UI/UIViewModel")
local TouringBandCfg = require("TableCfg/TouringBandCfg")
local TouringBandDefine = require("Game/TouringBand/TouringBandDefine")

local TouringBandMgr = nil

---@type TouringBandPosterItemVM : UIViewModel
local TouringBandPosterItemVM = LuaClass(UIViewModel)

function TouringBandPosterItemVM:Ctor()
    TouringBandMgr = _G.TouringBandMgr
    self.BandID = 0
    self.TexturePath = ""
    self.IsFans = false
    self.TextTag = ""
    self.TextTitle = ""
    self.TextContent = ""
    self.IsShowTag = true
    self.IsShowLine = true
    self.IsShowMask = true
end

function TouringBandPosterItemVM:UpdateVM(BandID, IsFromGuideView)
    self.BandID = BandID
    local Cfg = TouringBandCfg:FindCfgByKey(self.BandID)
    if Cfg == nil then return end

    local IsUnLock = TouringBandMgr:IsBandUnLockByID(self.BandID)
    local IsFans = TouringBandMgr:IsBandFansByID(self.BandID)

    self.IsShowLine = true
    self.IsShowMask = true
    if IsUnLock then
        self.IsFans = IsFans
        self.TexturePath = Cfg.UnLockPoster or TouringBandDefine.DEFAULT_POSTER_TEXTURE
        if IsFromGuideView then
            self.IsShowTag = true
            local CheeringNum = TouringBandMgr:GetBandCheeringNum(self.BandID)
            -- LSTR string: 聆听%d次
            local TextTag = string.format(_G.LSTR(450018), CheeringNum)
            self.TextTag = TextTag
            self.TextTitle = Cfg.BandName or ""
            self.TextContent = Cfg.Condition or ""
        else
            self.IsShowTag = false
            self.IsShowMask = false
            self.IsShowLine = false
            self.TextTitle = ""
            self.TextContent = ""
        end
    else
        self.IsFans = false
        self.TexturePath = Cfg.LockPoster or TouringBandDefine.DEFAULT_POSTER_TEXTURE
        self.IsShowTag = false
        self.TextTitle = "????"
        self.TextContent = "????"
    end
end

return TouringBandPosterItemVM